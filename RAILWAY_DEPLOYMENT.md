# ğŸš€ HOKORI WEB - RAILWAY DEPLOYMENT GUIDE

## ğŸ“‹ **Environment Variables cáº§n thiáº¿t trÃªn Railway:**

### ğŸ”‘ **Database Configuration (AUTO-GENERATED by Railway)**
```bash
# Railway tá»± Ä‘á»™ng táº¡o khi add PostgreSQL service:
DATABASE_URL=postgresql://username:password@host:port/database
# KhÃ´ng cáº§n set DATABASE_USERNAME vÃ  DATABASE_PASSWORD riÃªng
```

### ğŸ”¥ **Firebase Configuration (OPTIONAL - cho Google Login)**
```bash
FIREBASE_ENABLED=true
FIREBASE_PROJECT_ID=your-firebase-project-id
FIREBASE_CREDENTIALS_PATH=classpath:firebase-service-account.json
```

### ğŸ” **JWT Configuration (REQUIRED)**
```bash
JWT_SECRET=your-super-secret-jwt-key-minimum-32-characters
JWT_EXPIRATION=86400000
```

### âš™ï¸ **Spring Configuration**
```bash
SPRING_PROFILES_ACTIVE=prod
JPA_DDL_AUTO=update
```

### ğŸ—„ï¸ **Database Pool Configuration (OPTIONAL)**
```bash
DB_POOL_SIZE=10
DB_POOL_MIN=2
DB_CONNECTION_TIMEOUT=20000
DB_IDLE_TIMEOUT=300000
```

---

## ğŸ› ï¸ **BÆ°á»›c deploy lÃªn Railway:**

### 1. **Táº¡o project trÃªn Railway**
```bash
# Káº¿t ná»‘i GitHub repo vá»›i Railway
# Chá»n repository: hokori-web
```

### 2. **ThÃªm PostgreSQL Database**
```bash
# Trong Railway dashboard:
# Add Service â†’ Database â†’ PostgreSQL
# Railway sáº½ tá»± Ä‘á»™ng táº¡o DATABASE_URL environment variable
```

### 3. **Cáº¥u hÃ¬nh Environment Variables**
```bash
# Trong Railway project settings â†’ Variables
# ThÃªm táº¥t cáº£ cÃ¡c biáº¿n environment á»Ÿ trÃªn
```

### 4. **Deploy**
```bash
# Railway sáº½ tá»± Ä‘á»™ng build vÃ  deploy
# Kiá»ƒm tra logs náº¿u cÃ³ lá»—i
```

---

## ğŸ”§ **API Endpoints cÃ³ sáºµn:**

### ğŸ” **Authentication**
```bash
POST /api/auth/register          # ÄÄƒng kÃ½ tÃ i khoáº£n má»›i
POST /api/auth/login             # ÄÄƒng nháº­p username/password
POST /api/auth/login/firebase    # ÄÄƒng nháº­p Google Firebase
POST /api/auth/refresh           # Refresh JWT token
POST /api/auth/validate          # Validate JWT token
```

### ğŸ“Š **Health Check**
```bash
GET /actuator/health             # Health check endpoint
GET /api/health                  # Custom health endpoint
```

### ğŸ“š **API Documentation**
```bash
GET /swagger-ui.html             # Swagger UI
GET /v3/api-docs                 # OpenAPI JSON
```

---

## ğŸ§ª **Test API vá»›i cURL:**

### 1. **ÄÄƒng kÃ½ tÃ i khoáº£n má»›i:**
```bash
curl -X POST https://your-app.railway.app/api/auth/register \
  -H "Content-Type: application/json" \
  -d '{
    "username": "testuser",
    "email": "test@example.com",
    "password": "password123",
    "displayName": "Test User",
    "country": "Vietnam",
    "nativeLanguage": "Vietnamese",
    "currentJlptLevel": "N5"
  }'
```

### 2. **ÄÄƒng nháº­p:**
```bash
curl -X POST https://your-app.railway.app/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{
    "username": "testuser",
    "password": "password123"
  }'
```

### 3. **Sá»­ dá»¥ng JWT token:**
```bash
curl -X GET https://your-app.railway.app/api/users/profile \
  -H "Authorization: Bearer YOUR_JWT_TOKEN_HERE"
```

---

## ğŸ¯ **CÃ¡c tÃ­nh nÄƒng Ä‘Ã£ hoÃ n thÃ nh:**

âœ… **Authentication System**
- âœ… Username/Password login
- âœ… Google Firebase login
- âœ… JWT token generation & validation
- âœ… User registration
- âœ… Password encryption (BCrypt)

âœ… **Database Setup**
- âœ… SQL Server integration
- âœ… User & Role entities
- âœ… Automatic role creation
- âœ… Connection pooling

âœ… **Security Configuration**
- âœ… JWT Authentication Filter
- âœ… CORS configuration
- âœ… Public endpoints protection
- âœ… Role-based access control

âœ… **Railway Deployment**
- âœ… Environment-based configuration
- âœ… Production-ready settings
- âœ… Health check endpoints
- âœ… Swagger documentation

---

## ğŸ” **Troubleshooting:**

### Database Connection Issues:
```bash
# Kiá»ƒm tra DATABASE_URL format
# Äáº£m báº£o SQL Server cho phÃ©p external connections
# Kiá»ƒm tra firewall settings
```

### JWT Token Issues:
```bash
# Äáº£m báº£o JWT_SECRET Ä‘á»§ dÃ i (>= 32 characters)
# Kiá»ƒm tra token expiration time
```

### Firebase Issues:
```bash
# Upload firebase-service-account.json vÃ o src/main/resources/
# Äáº·t FIREBASE_ENABLED=false náº¿u khÃ´ng dÃ¹ng Google login
```

---

## ğŸš€ **Ready to Deploy!**

Project Ä‘Ã£ sáºµn sÃ ng deploy lÃªn Railway vá»›i Ä‘áº§y Ä‘á»§ tÃ­nh nÄƒng authentication cho web há»c tiáº¿ng Nháº­t!
